<!DOCTYPE html>
<html lang="pt-BR">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Kits Criados - Agendamento</title>
    <link rel="stylesheet" href="../CSS/professor.css">
    <link rel="stylesheet" href="../CSS/criar_kit.css">

    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Roboto:wght@400;500;700&display=swap" rel="stylesheet">

    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.2/css/all.min.css">
</head>

<body>

    <header id="cps-header">
        <div class="cps-header__container">
            <div class="logo-container">
                <a href="index.html">
                    <img src="../Assets/etec2.png" alt="Logo Etec J√∫lio de Mesquita" class="logo-etec">
                </a>
                <a href="https://www.cps.sp.gov.br/" target="_blank">
                    <img src="../Assets/etec.png" alt="Logo Centro Paula Souza" class="logo-cps">
                </a>
            </div>
        </div>
    </header>

    <div id="breadcrumb">
        <div class="breadcrumb-container">
            <span><a href="#">Home</a> / <a href="login.html">Agendamentos</a> / <a
                    href="professor.html">Professores</a> / Kits Criados</span>
        </div>
    </div>

    <main class="main-content">
        <h1 class="page-title">Kits Criados</h1>
        <div class="title-underline"></div>

        <div class="kit-manager-container">

            <div class="kit-list-container">
                <div class="kit-item">
                    <button class="kit-btn">Kit 1</button>
                    <div class="kit-actions">
                        <button class="action-btn acessar">Acessar</button>
                        <button class="action-btn renomear">Renomear</button>
                        <button class="action-btn deletar">Deletar</button>
                    </div>
                </div>

                <div class="kit-item">
                    <button class="kit-btn">Kit 2</button>
                    <div class="kit-actions">
                        <button class="action-btn acessar">Acessar</button>
                        <button class="action-btn renomear">Renomear</button>
                        <button class="action-btn deletar">Deletar</button>
                    </div>
                </div>

                <div class="kit-item">
                    <button class="kit-btn">Kit 3</button>
                    <div class="kit-actions">
                        <button class="action-btn acessar">Acessar</button>
                        <button class="action-btn renomear">Renomear</button>
                        <button class="action-btn deletar">Deletar</button>
                    </div>
                </div>

                <div class="kit-item">
                    <button class="kit-btn">Kit 4</button>
                    <div class="kit-actions">
                        <button class="action-btn acessar">Acessar</button>
                        <button class="action-btn renomear">Renomear</button>
                        <button class="action-btn deletar">Deletar</button>
                    </div>
                </div>

                <div class="kit-item">
                    <button class="kit-btn">Kit 5</button>
                    <div class="kit-actions">
                        <button class="action-btn acessar">Acessar</button>
                        <button class="action-btn renomear">Renomear</button>
                        <button class="action-btn deletar">Deletar</button>
                    </div>
                </div>

                <div class="kit-item">
                    <button class="kit-btn">Kit 6</button>
                    <div class="kit-actions">
                        <button class="action-btn acessar">Acessar</button>
                        <button class="action-btn renomear">Renomear</button>
                        <button class="action-btn deletar">Deletar</button>
                    </div>
                </div>
            </div>

            <div class="vertical-separator"></div>
            <div class="kit-main-view"></div>

            <!-- Bot√£o flutuante -->
            <button id="history-btn" class="floating-btn" title="Hist√≥rico">
                <i class="fa-solid fa-clock-rotate-left"></i>
            </button>
        </div>
    </main>

    <!-- Script -->
    <script>
    document.addEventListener('DOMContentLoaded', function () {
        const kitItems = document.querySelectorAll('.kit-item');
        const mainView = document.querySelector('.kit-main-view');
        const historyBtn = document.getElementById('history-btn');

        mainView.innerHTML = '<p class="placeholder">Aguardando sele√ß√£o de kit...</p>';

        // Sele√ß√£o e a√ß√µes b√°sicas
        kitItems.forEach((item, index) => {
            const kitButton = item.querySelector('.kit-btn');
            const renameButton = item.querySelector('.renomear');
            const deleteButton = item.querySelector('.deletar');
            const accessButton = item.querySelector('.acessar');

            kitButton.addEventListener('click', function () {
                kitItems.forEach(i => i.classList.remove('active'));
                item.classList.add('active');
            });

            accessButton.addEventListener('click', function (event) {
                event.stopPropagation();
                const nomeKit = kitButton.textContent.trim();
                mainView.innerHTML = `<p>üì¶ Exibindo informa√ß√µes de <strong>${nomeKit}</strong></p>`;
                showMessage(`Kit "${nomeKit}" acessado.`, true);
            });

            deleteButton.addEventListener('click', function (event) {
                event.stopPropagation();
                openPopupConfirm({
                    message: "Deseja realmente limpar os dados do kit?",
                    onConfirm: () => {
                        const kitNum = index + 1;
                        kitButton.textContent = `Kit ${kitNum}`;
                        mainView.innerHTML = '<p class="placeholder">Aguardando sele√ß√£o de kit...</p>';
                        showMessage("Kit redefinido com sucesso!", true);
                    },
                    onCancel: () => {
                        showMessage("A√ß√£o cancelada.", false);
                    }
                });
            });

            renameButton.addEventListener('click', function (event) {
                event.stopPropagation();
                openPopupRename({
                    currentName: kitButton.textContent,
                    onConfirm: (novoNome) => {
                        if (novoNome && novoNome.trim() !== "") {
                            kitButton.textContent = novoNome.trim();
                            showMessage("Kit renomeado com sucesso!", true);
                        } else {
                            showMessage("Nome inv√°lido. Nenhuma altera√ß√£o feita.", false);
                        }
                    }
                });
            });
        });

        // === Bot√£o de Hist√≥rico ===
        historyBtn.addEventListener('click', () => {
            openHistoryPopup();
        });

        // Fun√ß√µes de Pop-ups reutiliz√°veis
        function openPopupConfirm({ message, onConfirm, onCancel }) {
            const overlay = document.createElement('div');
            overlay.classList.add('popup-overlay');
            overlay.innerHTML = `
                <div class="popup">
                    <h3>${message}</h3>
                    <button id="confirmar">Confirmar</button>
                    <button id="cancelar">Cancelar</button>
                </div>
            `;
            document.body.appendChild(overlay);
            overlay.style.display = 'flex';

            overlay.querySelector('#confirmar').addEventListener('click', () => {
                overlay.remove();
                onConfirm();
            });

            overlay.querySelector('#cancelar').addEventListener('click', () => {
                overlay.remove();
                onCancel();
            });
        }

        function openPopupRename({ currentName, onConfirm }) {
            const overlay = document.createElement('div');
            overlay.classList.add('popup-overlay');
            overlay.innerHTML = `
                <div class="popup">
                    <h3>Renomear Kit</h3>
                    <input type="text" id="novoNome" value="${currentName}">
                    <div>
                        <button id="confirmar">Confirmar</button>
                        <button id="cancelar">Cancelar</button>
                    </div>
                </div>
            `;
            document.body.appendChild(overlay);
            overlay.style.display = 'flex';
            const input = overlay.querySelector('#novoNome');
            input.focus();

            overlay.querySelector('#confirmar').addEventListener('click', () => {
                const novoNome = input.value;
                overlay.remove();
                onConfirm(novoNome);
            });

            overlay.querySelector('#cancelar').addEventListener('click', () => {
                overlay.remove();
                showMessage("A√ß√£o cancelada.", false);
            });
        }

        function openHistoryPopup() {
            const overlay = document.createElement('div');
            overlay.classList.add('popup-overlay');
            overlay.innerHTML = `
                <div class="popup">
                    <h3>√öltimos materiais utilizados</h3>
                    <p style="font-size: 0.9rem; color:#444; margin-bottom: 15px;">
                        (aqui futuramente podem aparecer os materiais mais usados)
                    </p>
                    <button id="salvarComo">Salvar como</button>
                </div>
            `;
            document.body.appendChild(overlay);
            overlay.style.display = 'flex';

            const salvarComoBtn = overlay.querySelector('#salvarComo');
            salvarComoBtn.addEventListener('click', () => {
                overlay.remove();
                openSalvarComoPopup();
            });
        }

        function openSalvarComoPopup() {
            const overlay = document.createElement('div');
            overlay.classList.add('popup-overlay');
            overlay.innerHTML = `
                <div class="popup">
                    <h3>Salvar conte√∫do em:</h3>
                    <div id="kitOptions">
                        ${Array.from({ length: 6 }, (_, i) => `<button class="kitOption">Kit ${i + 1}</button>`).join('')}
                    </div>
                </div>
            `;
            document.body.appendChild(overlay);
            overlay.style.display = 'flex';

            overlay.querySelectorAll('.kitOption').forEach(btn => {
                btn.addEventListener('click', () => {
                    const nomeKit = btn.textContent;
                    overlay.remove();
                    openPopupConfirm({
                        message: `Deseja substituir o conte√∫do de ${nomeKit}?`,
                        onConfirm: () => {
                            overlay.remove();
                            openPopupRename({
                                currentName: nomeKit,
                                onConfirm: (novoNome) => {
                                    showMessage(`Conte√∫do salvo em "${novoNome}"!`, true);
                                }
                            });
                        },
                        onCancel: () => {
                            showMessage("A√ß√£o cancelada.", false);
                        }
                    });
                });
            });
        }

        // Mensagem flutuante
        function showMessage(text, success) {
            const msg = document.createElement('div');
            msg.classList.add('popup-message');
            msg.textContent = text;
            msg.style.backgroundColor = success ? '#d4edda' : '#f8d7da';
            msg.style.color = success ? '#155724' : '#721c24';
            document.body.appendChild(msg);
            msg.style.display = 'block';
            setTimeout(() => {
                msg.remove();
            }, 2500);
        }
    });
    </script>
</body>
</html>
